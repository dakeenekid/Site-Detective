from . import AWSObject, AWSProperty
from .validators import integer


class ScalableTarget(AWSObject):
    resource_type = "AWS::ApplicationAutoScaling::ScalableTarget"

    props = {
        'MaxCapacity': (integer, True),
        'MinCapacity': (integer, True),
        'ResourceId': (str, True),
        'RoleARN': (str, True),
        'ScalableDimension': (str, True),
        'ServiceNamespace': (str, True),
    }


class StepAdjustment(AWSProperty):
    props = {
        'MetricIntervalLowerBound': (integer, False),
        'MetricIntervalUpperBound': (integer, False),
        'ScalingAdjustment': (integer, True),
    }


class StepScalingPolicyConfiguration(AWSProperty):
    props = {
        'AdjustmentType': (str, False),
        'Cooldown': (integer, False),
        'MetricAggregationType': (str, False),
        'MinAdjustmentMagnitude': (integer, False),
        'StepAdjustments': ([StepAdjustment], False),
    }


class ScalingPolicy(AWSObject):
    resource_type = "AWS::ApplicationAutoScaling::ScalingPolicy"

    props = {
        'PolicyName': (str, True),
        'PolicyType': (str, False),
        'ResourceId': (str, False),
        'ScalableDimension': (str, False),
        'ServiceNamespace': (str, False),
        'ScalingTargetId': (str, False),
        'StepScalingPolicyConfiguration': (
            StepScalingPolicyConfiguration,
            False,
        ),
    }
